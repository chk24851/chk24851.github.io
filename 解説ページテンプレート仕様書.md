# 解説ページテンプレート仕様書

## ファイル構成

### 共通JavaScript
- `components/explanation-normal.js` - Normal（6ステージ）版
- `components/explanation-extra.js` - Extra（単一ステージ）版

### 説明ページ
各作品 > th# > `{difficulty}_{character}_{weapon}.html`

例:
- `blog/th6/normal_reimu_a.html`
- `blog/th6/extra_marisa_b.html`
- `blog/th7/normal_youmu_a.html`

---

## Normal版テンプレート（6ステージ）

### HTML構造

```html
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ちこいアーカイブ</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='75' font-size='75' text-anchor='middle' x='50'>🐮</text></svg>">
    <link rel="stylesheet" href="../../style.css">
</head>
<body>

    <div class="container">
        <h1>【Normal】キャラ名（武装名）</h1>

        <div class="video-container">
            <div class="video-panel">
                <div class="video-wrapper">
                    <iframe id="videoFrame" data-video-id="VIDEO_ID" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
                </div>
            </div>

            <div class="timestamps-panel">
                <div class="stage-selector">
                    <button class="stage-arrow" id="prev-stage">←</button>
                    <select id="stage-dropdown">
                        <option value="1">1面</option>
                        <option value="2">2面</option>
                        <option value="3">3面</option>
                        <option value="4">4面</option>
                        <option value="5">5面</option>
                        <option value="6">6面</option>
                    </select>
                    <button class="stage-arrow" id="next-stage">→</button>
                </div>

                <div class="timestamps-list" id="timestamps-list">
                    <ul></ul>
                </div>
            </div>
        </div>

        <div class="content-panel" id="content-panel">
            <div id="content-default" class="stamp-content">
                <h3>【Normal】キャラ名（武装名）</h3>
                <p>このページは【Normal】難度での攻略解説です。タイムスタンプを選択して、各シーンの詳細を確認してください。</p>
            </div>
            <!-- 各ステージのタイムスタンプコンテンツ -->
            <!-- ステージ1 -->
            <div id="content-1-0" class="stamp-content hidden">
                <h3>タイムスタンプ1</h3>
                <p>説明を書きます。</p>
            </div>
            <div id="content-1-1" class="stamp-content hidden">
                <h3>タイムスタンプ2</h3>
                <p>説明を書きます。</p>
            </div>
            <!-- ステージ2 -->
            <div id="content-2-0" class="stamp-content hidden">
                <h3>タイムスタンプ3</h3>
                <p>説明を書きます。</p>
            </div>
            <div id="content-2-1" class="stamp-content hidden">
                <h3>タイムスタンプ4</h3>
                <p>説明を書きます。</p>
            </div>
            <!-- ステージ3 -->
            <div id="content-3-0" class="stamp-content hidden">
                <h3>タイムスタンプ5</h3>
                <p>説明を書きます。</p>
            </div>
            <div id="content-3-1" class="stamp-content hidden">
                <h3>タイムスタンプ6</h3>
                <p>説明を書きます。</p>
            </div>
            <!-- ステージ4 -->
            <div id="content-4-0" class="stamp-content hidden">
                <h3>タイムスタンプ7</h3>
                <p>説明を書きます。</p>
            </div>
            <div id="content-4-1" class="stamp-content hidden">
                <h3>タイムスタンプ8</h3>
                <p>説明を書きます。</p>
            </div>
            <!-- ステージ5 -->
            <div id="content-5-0" class="stamp-content hidden">
                <h3>タイムスタンプ9</h3>
                <p>説明を書きます。</p>
            </div>
            <div id="content-5-1" class="stamp-content hidden">
                <h3>タイムスタンプ10</h3>
                <p>説明を書きます。</p>
            </div>
            <!-- ステージ6 -->
            <div id="content-6-0" class="stamp-content hidden">
                <h3>タイムスタンプ11</h3>
                <p>説明を書きます。</p>
            </div>
            <div id="content-6-1" class="stamp-content hidden">
                <h3>タイムスタンプ12</h3>
                <p>説明を書きます。</p>
            </div>
        </div>
    </div>

    <script src="../../components/loader.js"></script>
    <script src="../../components/explanation-normal.js"></script>
    <script>
        // ステージごとのタイムスタンプデータを管理
        const stageData = {
            1: {
                timestamps: [
                    { time: 10, label: 'タイムスタンプ1' },
                    { time: 30, label: 'タイムスタンプ2' }
                ]
            },
            2: {
                timestamps: [
                    { time: 20, label: 'タイムスタンプ3' },
                    { time: 40, label: 'タイムスタンプ4' }
                ]
            },
            3: {
                timestamps: [
                    { time: 50, label: 'タイムスタンプ5' },
                    { time: 70, label: 'タイムスタンプ6' }
                ]
            },
            4: {
                timestamps: [
                    { time: 80, label: 'タイムスタンプ7' },
                    { time: 100, label: 'タイムスタンプ8' }
                ]
            },
            5: {
                timestamps: [
                    { time: 120, label: 'タイムスタンプ9' },
                    { time: 140, label: 'タイムスタンプ10' }
                ]
            },
            6: {
                timestamps: [
                    { time: 160, label: 'タイムスタンプ11' },
                    { time: 180, label: 'タイムスタンプ12' }
                ]
            }
        };

        // 初期化（オプション: contentIdsカスタマイズ不要なら{}でOK）
        initializeExplanationPage(stageData, {});
    </script>
    <script src="../../components/loader.js"></script>
</body>
</html>
```

### 編集ポイント（Normal版）

1. **タイトル変更**
   ```html
   <h1>【Normal】キャラ名（武装名）</h1>
   ```
   - コンテンツデフォルトの`<h3>`も同じ内容に

2. **動画ID設定**
   ```html
   <iframe id="videoFrame" data-video-id="VIDEO_ID" ...
   ```
   - YouTubeビデオURLから `watch?v=` の後の文字列をコピー

3. **タイムスタンプ・ラベル編集**
   ```javascript
   1: {
       timestamps: [
           { time: 10, label: 'タイムスタンプ1' },
           { time: 30, label: 'タイムスタンプ2' }
       ]
   }
   ```
   - `time`: 秒数
   - `label`: タイムスタンプリストに表示される名前

4. **説明文編集**
   ```html
   <div id="content-1-0" class="stamp-content hidden">
       <h3>タイムスタンプ1</h3>
       <p>説明を書きます。</p>
   </div>
   ```
   - ID `content-{stage}-{index}` は自動参照されるため変更不可

---

## Extra版テンプレート（単一ステージ）

### HTML構造

```html
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ちこいアーカイブ</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='75' font-size='75' text-anchor='middle' x='50'>🐮</text></svg>">
    <link rel="stylesheet" href="../../style.css">
</head>
<body>

    <div class="container">
        <h1>【Extra】キャラ名（武装名）</h1>

        <div class="video-container">
            <div class="video-panel">
                <div class="video-wrapper">
                    <iframe id="videoFrame" data-video-id="VIDEO_ID" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
                </div>
            </div>

            <div class="timestamps-panel">
                <div class="timestamps-list" id="timestamps-list">
                    <ul></ul>
                </div>
            </div>
        </div>

        <div class="content-panel" id="content-panel">
            <div id="content-default" class="stamp-content">
                <h3>【Extra】キャラ名（武装名）</h3>
                <p>このページは【Extra】難度での攻略解説です。タイムスタンプを選択して、各シーンの詳細を確認してください。</p>
            </div>
            <div id="content-0" class="stamp-content hidden">
                <h3>タイムスタンプ1</h3>
                <p>説明を書きます。</p>
            </div>
            <div id="content-1" class="stamp-content hidden">
                <h3>タイムスタンプ2</h3>
                <p>説明を書きます。</p>
            </div>
            <div id="content-2" class="stamp-content hidden">
                <h3>タイムスタンプ3</h3>
                <p>説明を書きます。</p>
            </div>
            <div id="content-3" class="stamp-content hidden">
                <h3>タイムスタンプ4</h3>
                <p>説明を書きます。</p>
            </div>
        </div>
    </div>

    <script src="../../components/loader.js"></script>
    <script src="../../components/explanation-extra.js"></script>
    <script>
        // タイムスタンプデータを管理
        const timestamps = [
            { time: 47, label: 'タイムスタンプ1' },
            { time: 216, label: 'タイムスタンプ2' },
            { time: 60, label: 'タイムスタンプ3' },
            { time: 120, label: 'タイムスタンプ4' }
        ];

        // 初期化（オプション: contentIdsカスタマイズ不要なら{}でOK）
        initializeExplanationPage(timestamps, {});
    </script>
    <script src="../../components/loader.js"></script>
</body>
</html>
```

### 編集ポイント（Extra版）

1. **タイトル変更** - Normal版と同じ
2. **動画ID設定** - Normal版と同じ
3. **タイムスタンプ編集**
   ```javascript
   const timestamps = [
       { time: 47, label: 'タイムスタンプ1' },
       { time: 216, label: 'タイムスタンプ2' },
       { time: 60, label: 'タイムスタンプ3' },
       { time: 120, label: 'タイムスタンプ4' }
   ];
   ```
   - 配列の個数に応じて、`content-0`、`content-1`... が自動参照

4. **説明文編集**
   ```html
   <div id="content-0" class="stamp-content hidden">
       <h3>タイムスタンプ1</h3>
       <p>説明を書きます。</p>
   </div>
   ```
   - ID `content-{index}` は自動参照されるため変更不可

---

## 主要な特徴

- ✓ 共通JavaScriptで重複コード排除
- ✓ 各ページは `<script>` タグでstageData/timestampsのみ定義
- ✓ Normal版は動的ステージセレクター対応（ドロップダウン + ← → ボタン）
- ✓ Extra版はシンプルなタイムスタンプリストのみ
- ✓ デフォルトコンテンツ自動表示
- ✓ 動画自動再生対応
- ✓ キーボード操作対応（Enter / Space）

---

## contentIdsカスタマイズ（上級）

IDをカスタマイズしたい場合、第2引数に指定可能：

```javascript
const contentIds = {
    '1-0': 'custom-id-1',
    '1-1': 'custom-id-2',
    // ...
};
initializeExplanationPage(stageData, contentIds);
```

通常は不要です。
