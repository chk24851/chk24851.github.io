<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>セットアップに関する補足</title>
  <style>
    body { display: none; }
  </style>
  <link rel="stylesheet" href="../../../style.css">
  <script src="../../../loader.js"></script>
</head>
<body>
  <div class="container">

    <h1>セットアップに関する補足</h1>

    <div class="setup-section">
      <h2>前提</h2>
      <p>このページではトルテルマジックのセットアップに必要なファイルやソフトウェアについて補足します。なお，ここではゲームを<strong>Windows 10</strong>上で正常に動作させ，<strong>コントローラ操作</strong>することを想定しています。導入するものは次の通りです。</p>
      <ul>
        <li>ゲームファイル</li>
        <li>Direct3D関連のDLLファイル</li>
        <li>エミュレータソフトウェア</li>
        <li>キー入力無効化ソフトウェア</li>
        <li>キー入力割り当てソフトウェア</li>
        <li>BGM再生ソフトウェア</li>
      </ul>
      <div class="note">
        <p><strong>注意</strong>: </p>
        <ul>
          <li>掲載しているリンクは誤操作防止のため，その先のウェブサイトへワンクリックで遷移しないようにしています。リンク切れの場合はウェブアーカイブ経由でのアクセスや有志の配布先のウェブサイトへのアクセス（二次配布が認められているものに限る）を試みてください。</li>
          <li>正常にセットアップを行うため，すべてのソフトウェアは管理者権限で起動してください。</li>
          <li>このページに掲載されている内容に関するすべての操作については一切の責任を負いかねます。</li>
        </ul>
      </div>
    </div>

    <div class="setup-section">
      <h2>【必須】ゲームファイル</h2>
      <p>トルテルマジックは<a href="http://isweb1.infoseek.co.jp/~hoe/program/tortestg/index.html" target="_blank" onclick="return false;" style="color: #d97037; text-decoration: underline;">ぴえとろ惑星－トルテルマジック</a>で配布されていたフリーゲームです。配布元のウェブサイトはすでに閉鎖されています。</p>
      <ol>
        <li><code>tmgc100+.lzh</code>をダウンロードして展開してください。</li>
      </ol>
      <p>展開したフォルダ内に<code>tmgc100+.exe</code>や<code>tmgc100+.txt</code>があります。</p>
    </div>

    <div class="setup-section">
      <h2>【必須】Direct3D関連のDLLファイル</h2>
      <p>トルテルマジックはDirect3Dを使用しており，Windows 10に標準搭載されていないファイル<code>d3drm.dll</code>が必要です。これは「DirectX End-User Runtimes (March 2009) - 日本語」に同梱されています。</p>
      <ol>
        <li><a href="https://www.microsoft.com/ja-jp/download/details.aspx?id=19743" target="_blank" onclick="return false;" style="color: #d97037; text-decoration: underline;">Download DirectX End-User Runtimes (March 2009) - 日本語 from Official Microsoft Download Center</a>から<code>directx_mar2009_redist.exe</code>をダウンロードして展開してください。配布はすでに終了しています。</li>
        <li>展開したフォルダ内の<code>dxnt.cab</code>を展開してください。</li>
        <li>展開したフォルダ内の<code>d3drm.dll</code>を<code>tmgc100+.exe</code>のあるフォルダへコピーしてください。</li>
      </ol>
    </div>

    <div class="setup-section">
      <h2>【必須】エミュレータソフトウェア</h2>
      <p>トルテルマジックはDirect3Dを使用しており，Windows 10では正常に動作しません。そのため，Direct3Dをエミュレートするソフトウェアが必要です。ここでは，その方法の一例として「dgVoodoo」を紹介します。</p>
        <ol>
          <li><a href="https://dege.freeweb.hu/dgVoodoo2/dgVoodoo2/#latest-stable-version" onclick="return false;" style="color: #d97037; text-decoration: underline;">Downloads - Dege's stuffs</a>からLatest stable versionのdgVoodooをダウンロードして展開してください。</li>
          <li>展開したフォルダ直下の<code>dgVoodooCpl.exe</code>，<code>MS > x86</code>フォルダ内の<code>D3DImm.dll</code>，<code>DDraw.dll</code>をすべて<code>tmgc100+.exe</code>のあるフォルダへコピーしてください。</li>
          <li><code>dgVoodooCpl.exe</code>を起動してください。</li>
          <li>
            Config folder / Running instanceの「.¥」を選択してください。また，次の通りに設定を変更してください。
            <ul>
              <li>General > Appearance
                <ul>
                  <li>
                    ラジオボタン「Full Screen」「Windowed」をいずれか選択
                    <p>フルスクリーンモードで起動したい場合は「Full Screen」，ウインドウモードで起動したい場合は「Windowed」を選択してください。</p>
                  </li>
                  <li>Windowedの右側のプルダウンボックスから「Streched, 4:3 Aspect Ratio」を選択</li>
                </ul>
              </li>
              <li>DirectX > Videocard
                <ul>
                  <li>プルダウンボックスから「Voodoo Virtual SVGA Card」を選択</li>
                  <li>VRAMの右側のプルダウンボックスから「64 MB」を選択</li>
                </ul>
              </li>
              <li>DirectX > Miscellanneous
                <ul>
                  <li>チェックボックス「dgVoodoo Watermark」を選択解除</li>
                </ul>
              </li>
            </ul>
          </li>
          <li>「Apply」を選択して設定を保存し，「OK」を選択して<code>dgVoodooCpl.exe</code>を終了してください。</li>
        </ol>
    </div>

    <div class="setup-section">
      <h2>キー入力無効化ソフトウェア</h2>
      <p>トルテルマジックには入力遅延があります。そのため，遅延のない操作をするためには<code>tmgc100+.txt</code>に掲載されているデフォルトのキー入力を無効にするとともに，新たにキー入力を割り当てる必要があります（後述の「キー入力割り当てソフト」を参照）。ここでは，その方法の一例として「HidHide」を紹介します。</p>
    </div>

    <div class="setup-section">
      <h2>キー入力割り当てソフトウェア</h2>
      <p>トルテルマジックにはキーコンフィグがありません。そのため，デフォルトのキー以外で操作するためには新たにキー入力を割り当てる必要があります。ここでは，その方法の一例として「JoyToKey」を紹介します。</p>
    </div>

    <div class="setup-section">
      <h2>BGM再生ソフトウェア</h2>
      <p>トルテルマジックのBGMファイルはMIDI形式になっており，Windows10にはMIDI音源「Microsoft GS Wavetable SW」が標準搭載されています。しかし，この音源では一部の音が正しく再生されないため，再生されるようにする必要があります。ここでは，その方法の一例として「YAMAHA XG WDM SoftSynthesizer」を紹介します。</p>
    </div>
  </div>
</body>
</html>